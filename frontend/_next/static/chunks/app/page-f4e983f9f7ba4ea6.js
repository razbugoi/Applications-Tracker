(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{85196:function(e,t,n){Promise.resolve().then(n.bind(n,68157))},68157:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var i=n(57437),s=n(48722),l=n(87138),a=n(2265),r=n(92800),o=n(37844),d=n(50644);let c=[{key:"Submitted",label:"Submitted",description:"Awaiting validation and ready for triage.",href:"/submitted"},{key:"Invalidated",label:"Invalidated",description:"Applications with outstanding issues to resolve.",href:"/invalidated"},{key:"Live",label:"Live",description:"Validated applications progressing through assessment.",href:"/live"},{key:"Determined",label:"Determined",description:"Completed cases with recorded outcomes.",href:"/determined"}];function u(){var e,t,n,u,I;let{data:L,isLoading:T,error:U,mutate:q}=(0,s.ZP)("dashboard-overview",async()=>{let[e,t,n,i,s]=await Promise.all([(0,r.L8)("Submitted"),(0,r.L8)("Invalidated"),(0,r.L8)("Live"),(0,r.L8)("Determined"),(0,r._7)()]),l={Submitted:e.items.length,Invalidated:t.items.length,Live:n.items.length,Determined:i.items.length,Issues:s.items.length};return{counts:l,latestIssues:s.items.slice(0,5),outcomeSummary:function(e){let t={total:e.length,approved:0,refused:0,withdrawn:0,approvalRate:0};return 0===e.length||(e.forEach(e=>{var n;let i=null!==(n=e.outcome)&&void 0!==n?n:"Pending";"Approved"===i||"Permitted"===i?t.approved+=1:"Refused"===i?t.refused+=1:"Withdrawn"===i&&(t.withdrawn+=1)}),t.approvalRate=0===t.total?0:t.approved/t.total*100),t}(i.items),upcomingDeterminations:function(e){let t=new Date;return e.filter(e=>{if(!e.determinationDate)return!1;let n=new Date(e.determinationDate);return!Number.isNaN(n.getTime())&&n>=t}).sort((e,t)=>{var n,i;return(null!==(n=e.determinationDate)&&void 0!==n?n:"").localeCompare(null!==(i=t.determinationDate)&&void 0!==i?i:"")})}([...n.items,...e.items])}}),_=(0,a.useMemo)(()=>{let e={};return null==L||L.latestIssues.forEach(t=>{var n;e[t.status]=(null!==(n=e[t.status])&&void 0!==n?n:0)+1}),e},[null==L?void 0:L.latestIssues]);return(0,i.jsxs)("div",{style:x,children:[(0,i.jsxs)("section",{style:h,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{margin:0},children:"Dashboard"}),(0,i.jsx)("p",{style:{margin:"8px 0 0",color:"var(--text-muted)",fontSize:16},children:"Keep track of workload, key statuses, and recent issues at a glance."})]}),(0,i.jsx)(d.a,{onCreated:async e=>{await q()}})]}),(0,i.jsxs)("section",{style:y,"aria-label":"Status summary",children:[c.map(e=>{var t,n;let s=null!==(n=null==L?void 0:null===(t=L.counts)||void 0===t?void 0:t[e.key])&&void 0!==n?n:0;return(0,i.jsxs)(l.default,{href:e.href,style:g,children:[(0,i.jsx)("span",{style:v,children:T?"—":s}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:b,children:e.label}),(0,i.jsx)("p",{style:j,children:e.description})]})]},e.key)}),(0,i.jsxs)(l.default,{href:"/issues",style:g,children:[(0,i.jsx)("span",{style:v,children:T?"—":null!==(t=null==L?void 0:null===(e=L.counts)||void 0===e?void 0:e.Issues)&&void 0!==t?t:0}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:b,children:"Issues"}),(0,i.jsx)("p",{style:j,children:"All application issues across the portfolio."})]})]},"issues")]}),(0,i.jsxs)("section",{style:w,"aria-label":"Recent issues",children:[(0,i.jsxs)("header",{style:C,children:[(0,i.jsx)("h2",{style:{margin:0},children:"Latest Issues"}),(0,i.jsx)(l.default,{href:"/issues",style:S,children:"View all issues"})]}),U&&(0,i.jsx)("p",{style:D,children:"Failed to load latest issues."}),!U&&(null!==(n=null==L?void 0:L.latestIssues.length)&&void 0!==n?n:0)===0&&!T&&(0,i.jsx)("p",{style:D,children:"No issues recorded yet."}),T&&(0,i.jsx)("p",{style:D,children:"Loading latest issues…"}),!T&&!U&&(null!==(u=null==L?void 0:L.latestIssues.length)&&void 0!==u?u:0)>0&&(0,i.jsx)("ul",{style:k,children:null==L?void 0:L.latestIssues.map(e=>(0,i.jsx)(p,{issue:e},e.issueId))})]}),(0,i.jsxs)("section",{style:R,"aria-label":"Issue distribution",children:[(0,i.jsx)("h2",{style:{margin:"0 0 12px"},children:"Issues snapshot"}),(0,i.jsx)("div",{style:P,children:["Open","In Progress","Resolved","Closed"].map(e=>{var t;return(0,i.jsxs)("span",{style:N,children:[e,": ",null!==(t=_[e])&&void 0!==t?t:0]},e)})})]}),(0,i.jsxs)("section",{style:R,"aria-label":"Upcoming determinations",children:[(0,i.jsxs)("header",{style:C,children:[(0,i.jsx)("h2",{style:{margin:0},children:"Upcoming determinations"}),(0,i.jsx)(l.default,{href:"/calendar",style:S,children:"View calendar"})]}),T&&(0,i.jsx)("p",{style:D,children:"Loading upcoming determinations…"}),!T&&(null!==(I=null==L?void 0:L.upcomingDeterminations.length)&&void 0!==I?I:0)===0&&(0,i.jsx)("p",{style:D,children:"No upcoming determination dates captured."}),!T&&L&&L.upcomingDeterminations.length>0&&(0,i.jsx)("ul",{style:O,children:L.upcomingDeterminations.slice(0,5).map(e=>(0,i.jsxs)("li",{style:E,children:[(0,i.jsx)(l.default,{href:(0,o.C)(e.applicationId),style:W,children:e.prjCodeName}),(0,i.jsx)("span",{style:{fontSize:12,color:"var(--text-muted)"},children:m(e.determinationDate)})]},e.applicationId))})]}),(0,i.jsxs)("section",{style:z,"aria-label":"Outcome snapshot",children:[(0,i.jsxs)("header",{style:C,children:[(0,i.jsx)("h2",{style:{margin:0},children:"Outcome snapshot"}),(0,i.jsx)(l.default,{href:"/outcomes",style:S,children:"View full report"})]}),T&&(0,i.jsx)("p",{style:D,children:"Loading outcome data…"}),!T&&(null==L?void 0:L.outcomeSummary)&&(0,i.jsxs)("div",{style:A,children:[(0,i.jsx)(f,{label:"Determined",value:L.outcomeSummary.total}),(0,i.jsx)(f,{label:"Approved",value:L.outcomeSummary.approved,tone:"success"}),(0,i.jsx)(f,{label:"Refused",value:L.outcomeSummary.refused,tone:"danger"}),(0,i.jsx)(f,{label:"Withdrawn",value:L.outcomeSummary.withdrawn,tone:"warning"}),(0,i.jsx)(f,{label:"Approval Rate",value:"".concat(L.outcomeSummary.approvalRate.toFixed(1),"%"),tone:"success"})]})]})]})}function p(e){var t;let{issue:n}=e;return(0,i.jsxs)("li",{style:I,children:[(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,i.jsx)("span",{style:{fontWeight:600},children:n.title}),(0,i.jsxs)("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[null!==(t=n.prjCodeName)&&void 0!==t?t:"Unknown project"," • ",n.status]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:16,fontSize:12,color:"var(--text-muted)"},children:[(0,i.jsxs)("span",{children:["Raised ",m(n.dateRaised)]}),(0,i.jsxs)("span",{children:["Due ",m(n.dueDate)]})]})]})}function f(e){let{label:t,value:n,tone:s="default"}=e;return(0,i.jsxs)("div",{style:{...L,...{default:{background:"rgba(37, 99, 235, 0.08)",color:"#1d4ed8"},success:{background:"rgba(34, 197, 94, 0.12)",color:"#15803d"},danger:{background:"rgba(220, 38, 38, 0.12)",color:"#b91c1c"},warning:{background:"rgba(234, 179, 8, 0.12)",color:"#b45309"}}[s]},children:[(0,i.jsx)("span",{style:{fontSize:12,fontWeight:600},children:t}),(0,i.jsx)("strong",{style:{fontSize:18},children:n})]})}function m(e){if(!e)return"—";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString()}let x={display:"flex",flexDirection:"column",gap:32,padding:"32px 24px 64px",maxWidth:1080,margin:"0 auto"},h={display:"flex",alignItems:"center",justifyContent:"space-between",gap:24,flexWrap:"wrap"},y={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:16,alignItems:"stretch"},g={display:"flex",flexDirection:"column",gap:12,padding:"20px 18px",borderRadius:18,border:"1px solid var(--border)",background:"rgba(255,255,255,0.8)",boxShadow:"0 14px 30px rgba(15, 23, 42, 0.08)",textDecoration:"none",color:"inherit"},v={fontSize:34,fontWeight:700},b={fontWeight:600,fontSize:16},j={margin:0,fontSize:12,color:"var(--text-muted)"},w={display:"flex",flexDirection:"column",gap:16},C={display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},S={fontSize:13,color:"var(--primary)",fontWeight:600},D={margin:0,padding:24,textAlign:"center",color:"var(--text-muted)",border:"1px dashed var(--border)",borderRadius:16},k={listStyle:"none",margin:0,padding:0,display:"flex",flexDirection:"column",gap:12},I={display:"flex",justifyContent:"space-between",alignItems:"center",gap:16,padding:"16px 18px",borderRadius:16,border:"1px solid var(--border)",background:"rgba(248, 250, 252, 0.9)"},R={display:"flex",flexDirection:"column",gap:12},P={display:"flex",flexWrap:"wrap",gap:12},N={borderRadius:999,border:"1px solid var(--border)",padding:"6px 12px",background:"rgba(37, 99, 235, 0.12)",fontSize:12,fontWeight:600,color:"var(--text)"},O={listStyle:"none",margin:0,padding:0,display:"flex",flexDirection:"column",gap:10},E={display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid var(--border)",borderRadius:12,padding:"10px 12px",background:"rgba(248, 250, 252, 0.9)"},z={border:"1px solid var(--border)",borderRadius:16,padding:20,background:"var(--surface)",display:"flex",flexDirection:"column",gap:16},A={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},L={display:"flex",flexDirection:"column",gap:6,borderRadius:14,padding:"12px 14px",border:"1px solid transparent"},W={fontWeight:600,textDecoration:"none",color:"var(--text)"}},50644:function(e,t,n){"use strict";n.d(t,{a:function(){return c}});var i=n(57437),s=n(2265),l=n(92800),a=n(54887);let r={md:560,lg:720,xl:900};function o(e){let{title:t,children:n,onClose:l,size:o="lg"}=e,[d,c]=(0,s.useState)(null);if((0,s.useEffect)(()=>{let e=document.createElement("div");document.body.appendChild(e);let t=document.body.style.overflow;document.body.style.overflow="hidden";let n=e=>{"Escape"===e.key&&l()};return document.addEventListener("keydown",n),c(e),()=>{document.removeEventListener("keydown",n),document.body.style.overflow=t,e.remove()}},[l]),!d)return null;let u=r[o];return(0,a.createPortal)((0,i.jsx)("div",{className:"modal-overlay",role:"presentation",onClick:l,children:(0,i.jsxs)("div",{className:"modal-content",style:{maxWidth:u},role:"dialog","aria-modal":"true","aria-label":null!=t?t:"Dialog",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("header",{className:"modal-header",children:[t&&(0,i.jsx)("h2",{children:t}),(0,i.jsx)("button",{type:"button",className:"modal-close",onClick:l,"aria-label":"Close dialog",children:"\xd7"})]}),(0,i.jsx)("div",{className:"modal-body",children:n})]})}),d)}let d={prjCodeName:"",ppReference:"",lpaReference:"",description:"",council:"",submissionDate:"",caseOfficer:"",caseOfficerEmail:"",planningPortalUrl:""};function c(e){let{onCreated:t}=e,[n,a]=(0,s.useState)(!1),[r,c]=(0,s.useState)(d),[y,g]=(0,s.useState)(!1),[v,b]=(0,s.useState)(null),j=e=>t=>{c(n=>({...n,[e]:t.target.value}))};async function w(e){e.preventDefault(),g(!0),b(null);try{let e={...r,submissionDate:r.submissionDate,planningPortalUrl:r.planningPortalUrl.trim()||void 0,caseOfficerEmail:r.caseOfficerEmail.trim()||void 0},n=await (0,l.W3)(e);t(n),c(d),a(!1)}catch(e){b(e instanceof Error?e.message:"Failed to create application")}finally{g(!1)}}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{type:"button",style:u,onClick:()=>a(!0),children:"+ New Application"}),n&&(0,i.jsx)(o,{title:"New Application",onClose:()=>y?void 0:a(!1),size:"lg",children:(0,i.jsxs)("form",{onSubmit:w,style:f,children:[(0,i.jsxs)("div",{style:m,children:[(0,i.jsxs)("label",{style:x,children:["Project Code & Name",(0,i.jsx)("input",{required:!0,value:r.prjCodeName,onChange:j("prjCodeName"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["PP Reference",(0,i.jsx)("input",{required:!0,value:r.ppReference,onChange:j("ppReference"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["LPA Reference",(0,i.jsx)("input",{value:r.lpaReference,onChange:j("lpaReference"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["Council",(0,i.jsx)("input",{required:!0,value:r.council,onChange:j("council"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["Case Officer",(0,i.jsx)("input",{value:r.caseOfficer,onChange:j("caseOfficer"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["Case Officer Email",(0,i.jsx)("input",{type:"email",value:r.caseOfficerEmail,onChange:j("caseOfficerEmail"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["Planning Portal URL",(0,i.jsx)("input",{value:r.planningPortalUrl,onChange:j("planningPortalUrl"),style:h})]}),(0,i.jsxs)("label",{style:x,children:["Submission Date",(0,i.jsx)("input",{required:!0,type:"date",value:r.submissionDate,onChange:j("submissionDate"),style:h})]})]}),(0,i.jsxs)("label",{style:x,children:["Description",(0,i.jsx)("textarea",{required:!0,value:r.description,onChange:j("description"),style:{...h,minHeight:120,resize:"vertical"}})]}),v&&(0,i.jsx)("p",{style:{color:"var(--danger)",fontSize:13},children:v}),(0,i.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:8},children:[(0,i.jsx)("button",{type:"button",style:p,onClick:()=>a(!1),disabled:y,children:"Cancel"}),(0,i.jsx)("button",{type:"submit",style:u,disabled:y,children:y?"Saving…":"Save Application"})]})]})})]})}let u={background:"var(--primary)",color:"#fff",border:"none",borderRadius:999,padding:"10px 18px",fontWeight:600,cursor:"pointer"},p={background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border)",borderRadius:999,padding:"10px 18px",fontWeight:600,cursor:"pointer"},f={display:"flex",flexDirection:"column",gap:16},m={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:16},x={display:"flex",flexDirection:"column",gap:6,fontSize:13,color:"var(--text-muted)"},h={padding:"8px 10px",borderRadius:8,border:"1px solid var(--border)",fontSize:14}},421:function(e,t,n){"use strict";n.d(t,{Z:function(){return u},q:function(){return c}});var i=n(4896);let s="eu-west-2",l="eu-west-2_Mp5QuBMEE",a="7p4cb8l4k8g9s2e9infoqoc6id",r="eu-west-2:76467ba5-5dcb-45e3-b2e9-91838ab508cd",o="https://hv16oj3j92.execute-api.eu-west-2.amazonaws.com/prod",d=!!(s&&l&&a&&r&&o);d&&i.V.configure({Auth:{Cognito:{userPoolId:l,userPoolClientId:a,identityPoolId:r,loginWith:{username:!1,email:!0,phone:!1}}},API:{REST:{PlanningTrackerApi:{endpoint:o,region:s}}}});let c=d,u=!1},92800:function(e,t,n){"use strict";n.d(t,{L8:function(){return r},UM:function(){return d},VG:function(){return u},W3:function(){return o},_7:function(){return f},ko:function(){return m},li:function(){return p},v:function(){return c}});var i=n(13280),s=n(421);async function l(){if(s.Z||!s.q)return{};try{var e,t;let n=await (0,i.y)(),s=null===(t=n.tokens)||void 0===t?void 0:null===(e=t.idToken)||void 0===e?void 0:e.toString();if(s)return{Authorization:"Bearer ".concat(s)}}catch(e){console.warn("Failed to fetch auth session",e)}return{}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Headers(t.headers);n.set("Content-Type","application/json"),Object.entries(await l()).forEach(e=>{let[t,i]=e;return n.set(t,i)});let i=await fetch("".concat("https://hv16oj3j92.execute-api.eu-west-2.amazonaws.com/prod").concat(e),{...t,headers:n});if(!i.ok)throw Error(await i.text()||"API request failed");if(204!==i.status)return i.json()}async function r(e){return a("/applications?status=".concat(encodeURIComponent(e)))}async function o(e){return a("/applications",{method:"POST",body:JSON.stringify(e)})}async function d(e){return a("/applications/".concat(e))}async function c(e,t){return a("/applications/".concat(e,"/issues"),{method:"POST",body:JSON.stringify(t)})}async function u(e,t,n){return a("/applications/".concat(e,"/issues/").concat(t),{method:"PATCH",body:JSON.stringify(n)})}async function p(e,t){return a("/applications/".concat(e),{method:"PATCH",body:JSON.stringify(t)})}async function f(e){let t=e?"?status=".concat(encodeURIComponent(e)):"";return a("/issues".concat(t))}async function m(e,t){return a("/applications/".concat(e,"/extensions"),{method:"POST",body:JSON.stringify(t)})}},37844:function(e,t,n){"use strict";function i(e){return"/applications/".concat(e)}n.d(t,{C:function(){return i}})}},function(e){e.O(0,[844,722,138,971,23,744],function(){return e(e.s=85196)}),_N_E=e.O()}]);