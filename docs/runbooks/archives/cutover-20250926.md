# Cutover Archive – 26 September 2025

## Timeline
- 11:05 UTC: Maintenance comms confirmed (see `docs/migration-decisions/2025-09-26-phase-6-cutover.md`).
- 11:08 UTC: Amplify `LEGACY_READ_ONLY_MODE=1` applied and writer Lambdas throttled (reserved concurrency set to 0).
- 11:12 UTC: DynamoDB export taken via `node export-data.js` (artifact: `supabase/exports/production-export-2025-09-26T11-39-34-627Z.json`).
- 11:32 UTC: Vercel production build + deploy completed (`applications-tracker-h0eg8hjl6-razvan-bugois-projects.vercel.app`).
- 11:43 UTC: Supabase production import executed (dry run then live).
- 11:48 UTC: Playwright + RLS security checks executed against production.
- 11:50 UTC: Health check script verified Vercel ↔ Supabase connectivity.

## Data Migration Summary
- Dry run: `node production-import.js --api https://applications-tracker.vercel.app/api --dry-run`
- Live import: `node production-import.js --api https://applications-tracker.vercel.app/api`
- Result: 44 applications created, 14 patched (status/outcome updates), 12 rows skipped.
- All `Outcome=Permitted` entries mapped to Supabase enum `Approved`.
- Validation: `content-range: 0-0/44` for `/rest/v1/applications?team_id=eq.00000000-0000-0000-0000-000000000001`.

### Skipped Rows (missing required spreadsheet fields)
- LiveApplications row 4 – 25/P/01191 (missing submission date)
- LiveApplications row 23 – DISC/25/0275 (missing submission date)
- LiveApplications rows 27–34 – blank rows used for spreadsheet spacing
- SubmittedApplications rows 5–6 – missing project code / submission date

Action: Flagged to data owner for follow-up amendments before re-import (Phase 6 retrospective).

## Deployment Details
- Commands: `npm run build`, `vercel build --prod`, `npm run deploy:prod -- --yes`
- Production alias: `applications-tracker.vercel.app`
- Commit baseline: main (pre-cutover)

## Validation & Monitoring
- Playwright: `E2E_BASE_URL=https://applications-tracker.vercel.app NEXT_PUBLIC_SUPABASE_BYPASS_AUTH=false npm run test:e2e` → 4/4 tests passed.
- RLS: `SUPABASE_ENV=.env.vercel npm run test:security` → anon access blocked.
- Health: `node health-check.js --api https://applications-tracker.vercel.app --supabase-url https://kswjftmtiuwplqtdwqpn.supabase.co --supabase-key <anon>` → all services healthy.
- Monitoring window: 26 Sept 12:00 UTC → 28 Sept 12:00 UTC using Vercel logs + Supabase dashboard alerts.

## Outstanding / Follow-Up
- DNS: awaiting council IT to repoint primary hostname from Amplify to Vercel.
- Post-cutover monitoring: capture incident log (if any) in `docs/runbooks/archives/cutover-20250926.md` after 48h.
- Data gaps: update spreadsheet rows listed above and re-run targeted import if required.
