(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{55047:function(e,t,n){Promise.resolve().then(n.bind(n,60944))},60944:function(e,t,n){"use strict";n.d(t,{CalendarView:function(){return m}});var i=n(57437),o=n(48722),r=n(87138),a=n(2265),l=n(92800),s=n(37844),d=n(74546);function c(e){let t=(0,d.Q)(e);return t.setDate(1),t.setHours(0,0,0,0),t}var u=n(11880);function p(e,t){let n=(0,d.Q)(e);if(isNaN(t))return(0,u.L)(e,NaN);if(!t)return n;let i=n.getDate(),o=(0,u.L)(e,n.getTime());return(o.setMonth(n.getMonth()+t+1,0),i>=o.getDate())?o:(n.setFullYear(o.getFullYear(),o.getMonth(),i),n)}var f=n(98089),y=n(21900),h=n(1774),g=n(40603);let x=["Submitted","Invalidated","Live","Determined"];function m(){let{data:e,error:t,isLoading:n}=(0,o.ZP)("calendar-apps",j),[r,l]=(0,a.useState)(()=>c(new Date)),s=(0,a.useMemo)(()=>{let t=new Map;return(null!=e?e:[]).forEach(e=>{var n;let i=e.date;t.has(i)||t.set(i,[]),null===(n=t.get(i))||void 0===n||n.push(e)}),t},[e]),y=(0,a.useMemo)(()=>(function(e,t){let n=(0,h.z)(c(e),{weekStartsOn:1}),i=function(e,t){var n,i,o,r,a,l,s,c;let u=(0,g.j)(),p=null!==(c=null!==(s=null!==(l=null!==(a=null==t?void 0:t.weekStartsOn)&&void 0!==a?a:null==t?void 0:null===(i=t.locale)||void 0===i?void 0:null===(n=i.options)||void 0===n?void 0:n.weekStartsOn)&&void 0!==l?l:u.weekStartsOn)&&void 0!==s?s:null===(r=u.locale)||void 0===r?void 0:null===(o=r.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==c?c:0,f=(0,d.Q)(e),y=f.getDay();return f.setDate(f.getDate()+((y<p?-7:0)+6-(y-p))),f.setHours(23,59,59,999),f}(function(e){let t=(0,d.Q)(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}(e),{weekStartsOn:1}),o=[],r=n;for(;r<=i;){let e=[];for(let n=0;n<7;n+=1){var a;let n=(0,f.WU)(r,"yyyy-MM-dd");e.push({date:r,iso:n,events:null!==(a=t.get(n))&&void 0!==a?a:[]}),r=function(e,t){let n=(0,d.Q)(e);return isNaN(1)?(0,u.L)(e,NaN):(n.setDate(n.getDate()+1),n)}(r,1)}o.push(e)}return o})(r,s),[r,s]);return(0,i.jsxs)("main",{style:w,children:[(0,i.jsxs)("header",{style:D,children:[(0,i.jsxs)("div",{style:S,children:[(0,i.jsx)("button",{type:"button",style:k,onClick:()=>l(e=>p(e,-1)),children:"←"}),(0,i.jsx)("h1",{style:{margin:0},children:(0,f.WU)(r,"MMMM yyyy")}),(0,i.jsx)("button",{type:"button",style:k,onClick:()=>l(e=>p(e,1)),children:"→"})]}),(0,i.jsx)("p",{style:{margin:"0 0 16px",color:"var(--text-muted)",fontSize:16},children:"Determination dates and extensions mapped on a monthly calendar."}),(0,i.jsxs)("div",{style:M,children:[(0,i.jsx)(v,{color:"rgba(59, 130, 246, 0.15)",border:"#1d4ed8",label:"Determination due"}),(0,i.jsx)(v,{color:"rgba(250, 204, 21, 0.25)",border:"#b45309",label:"Extension of time"})]})]}),n&&(0,i.jsx)("p",{style:F,children:"Loading calendar…"}),t&&(0,i.jsx)("p",{style:{...F,color:"var(--danger)"},children:"Failed to load calendar events."}),!n&&!t&&(0,i.jsxs)("section",{style:C,children:[(0,i.jsx)("div",{style:N,children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(e=>(0,i.jsx)("span",{style:O,children:e},e))}),(0,i.jsx)("div",{style:P,children:y.map((e,t)=>(0,i.jsx)("div",{style:T,children:e.map(e=>(0,i.jsx)(b,{day:e,currentMonth:r},e.iso))},t))})]})]})}function b(e){var t;let{day:n,currentMonth:o}=e,{date:a,iso:l,events:c}=n,u=function(e,t){let n=(0,d.Q)(e),i=(0,d.Q)(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}(a,o),p=(t=new Date,+(0,y.b)(a)==+(0,y.b)(t));return(0,i.jsxs)("div",{style:{...E,opacity:u?1:.4,borderColor:p?"var(--primary)":"transparent"},children:[(0,i.jsx)("div",{style:I,children:(0,f.WU)(a,"d")}),(0,i.jsx)("div",{style:z,children:c.map(e=>(0,i.jsxs)(r.default,{href:(0,s.C)(e.application.applicationId),style:{...W,background:"Determination"===e.type?"rgba(59, 130, 246, 0.15)":"rgba(250, 204, 21, 0.25)",borderColor:"Determination"===e.type?"#1d4ed8":"#b45309",color:"Determination"===e.type?"#1d4ed8":"#b45309"},children:[(0,i.jsx)("span",{children:e.application.prjCodeName}),(0,i.jsx)("span",{style:{fontSize:11,opacity:.85},children:e.type})]},e.id))})]})}function v(e){let{color:t,border:n,label:o}=e;return(0,i.jsx)("span",{style:{...A,background:t,borderColor:n,color:n},children:o})}async function j(){let e=(await Promise.all(x.map(e=>(0,l.L8)(e)))).flatMap(e=>e.items),t=[];return e.forEach(e=>{e.determinationDate&&t.push({id:"".concat(e.applicationId,"-determination"),application:e,date:e.determinationDate,type:"Determination"}),e.eotDate&&t.push({id:"".concat(e.applicationId,"-eot"),application:e,date:e.eotDate,type:"Extension"})}),t}let w={maxWidth:1080,margin:"0 auto",padding:"32px 24px 64px",display:"flex",flexDirection:"column",gap:24},D={display:"flex",flexDirection:"column",gap:16},S={display:"flex",alignItems:"center",gap:16},k={background:"rgba(37, 99, 235, 0.12)",border:"none",borderRadius:"50%",width:32,height:32,fontSize:16,cursor:"pointer"},M={display:"flex",gap:12,flexWrap:"wrap"},C={border:"1px solid var(--border)",borderRadius:20,background:"var(--surface)",padding:20,boxShadow:"0 20px 40px rgba(15, 23, 42, 0.1)",display:"flex",flexDirection:"column",gap:16},N={display:"grid",gridTemplateColumns:"repeat(7, 1fr)",textAlign:"center",fontSize:13,fontWeight:600,color:"var(--text-muted)"},O={paddingBottom:12},P={display:"flex",flexDirection:"column",gap:8},T={display:"grid",gridTemplateColumns:"repeat(7, minmax(0, 1fr))",gap:8},E={minHeight:120,borderRadius:16,border:"2px solid transparent",background:"rgba(248, 250, 252, 0.95)",padding:12,display:"flex",flexDirection:"column",gap:8,boxShadow:"0 8px 24px rgba(15, 23, 42, 0.06)"},I={fontWeight:700,fontSize:14},z={display:"flex",flexDirection:"column",gap:6},W={borderRadius:14,border:"1px solid transparent",padding:"6px 8px",fontSize:12,display:"flex",flexDirection:"column",textDecoration:"none"},A={border:"1px solid",borderRadius:999,padding:"4px 12px",fontSize:12,fontWeight:600},F={padding:24,textAlign:"center",color:"var(--text-muted)"}},421:function(e,t,n){"use strict";n.d(t,{Z:function(){return u},q:function(){return c}});var i=n(4896);let o="eu-west-2",r="eu-west-2_Mp5QuBMEE",a="7p4cb8l4k8g9s2e9infoqoc6id",l="eu-west-2:76467ba5-5dcb-45e3-b2e9-91838ab508cd",s="https://hv16oj3j92.execute-api.eu-west-2.amazonaws.com/prod",d=!!(o&&r&&a&&l&&s);d&&i.V.configure({Auth:{Cognito:{userPoolId:r,userPoolClientId:a,identityPoolId:l,loginWith:{username:!1,email:!0,phone:!1}}},API:{REST:{PlanningTrackerApi:{endpoint:s,region:o}}}});let c=d,u=!1},92800:function(e,t,n){"use strict";n.d(t,{L8:function(){return l},UM:function(){return d},VG:function(){return u},W3:function(){return s},_7:function(){return f},ko:function(){return y},li:function(){return p},v:function(){return c}});var i=n(13280),o=n(421);async function r(){if(o.Z||!o.q)return{};try{var e,t;let n=await (0,i.y)(),o=null===(t=n.tokens)||void 0===t?void 0:null===(e=t.idToken)||void 0===e?void 0:e.toString();if(o)return{Authorization:"Bearer ".concat(o)}}catch(e){console.warn("Failed to fetch auth session",e)}return{}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Headers(t.headers);n.set("Content-Type","application/json"),Object.entries(await r()).forEach(e=>{let[t,i]=e;return n.set(t,i)});let i=await fetch("".concat("https://hv16oj3j92.execute-api.eu-west-2.amazonaws.com/prod").concat(e),{...t,headers:n});if(!i.ok)throw Error(await i.text()||"API request failed");if(204!==i.status)return i.json()}async function l(e){return a("/applications?status=".concat(encodeURIComponent(e)))}async function s(e){return a("/applications",{method:"POST",body:JSON.stringify(e)})}async function d(e){return a("/applications/".concat(e))}async function c(e,t){return a("/applications/".concat(e,"/issues"),{method:"POST",body:JSON.stringify(t)})}async function u(e,t,n){return a("/applications/".concat(e,"/issues/").concat(t),{method:"PATCH",body:JSON.stringify(n)})}async function p(e,t){return a("/applications/".concat(e),{method:"PATCH",body:JSON.stringify(t)})}async function f(e){let t=e?"?status=".concat(encodeURIComponent(e)):"";return a("/issues".concat(t))}async function y(e,t){return a("/applications/".concat(e,"/extensions"),{method:"POST",body:JSON.stringify(t)})}},37844:function(e,t,n){"use strict";function i(e){return"/applications/".concat(e)}n.d(t,{C:function(){return i}})}},function(e){e.O(0,[844,722,138,89,971,23,744],function(){return e(e.s=55047)}),_N_E=e.O()}]);