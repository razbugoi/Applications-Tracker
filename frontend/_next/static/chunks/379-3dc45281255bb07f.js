(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[379],{21379:function(e,n,t){Promise.resolve().then(t.bind(t,54357))},16463:function(e,n,t){"use strict";var i=t(71169);t.o(i,"usePathname")&&t.d(n,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(n,{useRouter:function(){return i.useRouter}})},50644:function(e,n,t){"use strict";t.d(n,{a:function(){return d}});var i=t(57437),l=t(2265),a=t(92800),o=t(54887);let s={md:560,lg:720,xl:900};function r(e){let{title:n,children:t,onClose:a,size:r="lg"}=e,[c,d]=(0,l.useState)(null);if((0,l.useEffect)(()=>{let e=document.createElement("div");document.body.appendChild(e);let n=document.body.style.overflow;document.body.style.overflow="hidden";let t=e=>{"Escape"===e.key&&a()};return document.addEventListener("keydown",t),d(e),()=>{document.removeEventListener("keydown",t),document.body.style.overflow=n,e.remove()}},[a]),!c)return null;let u=s[r];return(0,o.createPortal)((0,i.jsx)("div",{className:"modal-overlay",role:"presentation",onClick:a,children:(0,i.jsxs)("div",{className:"modal-content",style:{maxWidth:u},role:"dialog","aria-modal":"true","aria-label":null!=n?n:"Dialog",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("header",{className:"modal-header",children:[n&&(0,i.jsx)("h2",{children:n}),(0,i.jsx)("button",{type:"button",className:"modal-close",onClick:a,"aria-label":"Close dialog",children:"\xd7"})]}),(0,i.jsx)("div",{className:"modal-body",children:t})]})}),c)}let c={prjCodeName:"",ppReference:"",lpaReference:"",description:"",council:"",submissionDate:"",caseOfficer:"",caseOfficerEmail:"",planningPortalUrl:""};function d(e){let{onCreated:n}=e,[t,o]=(0,l.useState)(!1),[s,d]=(0,l.useState)(c),[x,y]=(0,l.useState)(!1),[v,j]=(0,l.useState)(null),b=e=>n=>{d(t=>({...t,[e]:n.target.value}))};async function C(e){e.preventDefault(),y(!0),j(null);try{let e={...s,submissionDate:s.submissionDate,planningPortalUrl:s.planningPortalUrl.trim()||void 0,caseOfficerEmail:s.caseOfficerEmail.trim()||void 0},t=await (0,a.W3)(e);n(t),d(c),o(!1)}catch(e){j(e instanceof Error?e.message:"Failed to create application")}finally{y(!1)}}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{type:"button",style:u,onClick:()=>o(!0),children:"+ New Application"}),t&&(0,i.jsx)(r,{title:"New Application",onClose:()=>x?void 0:o(!1),size:"lg",children:(0,i.jsxs)("form",{onSubmit:C,style:h,children:[(0,i.jsxs)("div",{style:f,children:[(0,i.jsxs)("label",{style:g,children:["Project Code & Name",(0,i.jsx)("input",{required:!0,value:s.prjCodeName,onChange:b("prjCodeName"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["PP Reference",(0,i.jsx)("input",{required:!0,value:s.ppReference,onChange:b("ppReference"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["LPA Reference",(0,i.jsx)("input",{value:s.lpaReference,onChange:b("lpaReference"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["Council",(0,i.jsx)("input",{required:!0,value:s.council,onChange:b("council"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["Case Officer",(0,i.jsx)("input",{value:s.caseOfficer,onChange:b("caseOfficer"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["Case Officer Email",(0,i.jsx)("input",{type:"email",value:s.caseOfficerEmail,onChange:b("caseOfficerEmail"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["Planning Portal URL",(0,i.jsx)("input",{value:s.planningPortalUrl,onChange:b("planningPortalUrl"),style:m})]}),(0,i.jsxs)("label",{style:g,children:["Submission Date",(0,i.jsx)("input",{required:!0,type:"date",value:s.submissionDate,onChange:b("submissionDate"),style:m})]})]}),(0,i.jsxs)("label",{style:g,children:["Description",(0,i.jsx)("textarea",{required:!0,value:s.description,onChange:b("description"),style:{...m,minHeight:120,resize:"vertical"}})]}),v&&(0,i.jsx)("p",{style:{color:"var(--danger)",fontSize:13},children:v}),(0,i.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:8},children:[(0,i.jsx)("button",{type:"button",style:p,onClick:()=>o(!1),disabled:x,children:"Cancel"}),(0,i.jsx)("button",{type:"submit",style:u,disabled:x,children:x?"Saving…":"Save Application"})]})]})})]})}let u={background:"var(--primary)",color:"#fff",border:"none",borderRadius:999,padding:"10px 18px",fontWeight:600,cursor:"pointer"},p={background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border)",borderRadius:999,padding:"10px 18px",fontWeight:600,cursor:"pointer"},h={display:"flex",flexDirection:"column",gap:16},f={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:16},g={display:"flex",flexDirection:"column",gap:6,fontSize:13,color:"var(--text-muted)"},m={padding:"8px 10px",borderRadius:8,border:"1px solid var(--border)",fontSize:14}},54357:function(e,n,t){"use strict";t.d(n,{StatusPage:function(){return f}});var i=t(57437),l=t(48722),a=t(92562),o=t(16463),s=t(92800),r=t(37844),c=JSON.parse('{"Ashford Borough Council":"https://planning.ashford.gov.uk/Planning/","Basingstoke and Deane Borough Council":"https://planning.basingstoke.gov.uk/online-applications/","Bromley Borough":"https://searchapplications.bromley.gov.uk/online-applications/","Chichester District Council":"https://publicaccess.chichester.gov.uk/online-applications/","Crawley Borough Council":"https://planningregister.crawley.gov.uk/online-applications/","Gravesham Borough Council":"https://plan.gravesham.gov.uk/online-applications/","Guildford Borough Council":"https://www.guildford.gov.uk/planningsearch","Horsham District Council":"https://public-access.horsham.gov.uk/public-access/","London Borough of Hillingdon":"https://planning.hillingdon.gov.uk/OcellaWeb/planningSearch","Mid Sussex District Council":"https://pa.midsussex.gov.uk/online-applications/","Mole Valley District Council":"https://molevalley-publicportal.statmap.co.uk/horizonext","Sevenoaks District Council":"https://pa.sevenoaks.gov.uk/online-applications/","Tandridge District Council":"https://www.tandridge.gov.uk/Planning-and-building/Planning-applications","Waverley Borough Council":"https://www.waverley.gov.uk/Services/Planning-and-building/Planning-applications-and-policy/Search-planning-applications","Wealden District Council":"https://planning.wealden.gov.uk/"}'),d=t(50644);let u={maxWidth:960,margin:"0 auto",padding:"32px 24px 64px",display:"flex",flexDirection:"column",gap:24},p={padding:48,textAlign:"center",color:"var(--text-muted)"},h={marginTop:8};function f(e){var n;let{status:t,title:f,subtitle:m}=e,{data:x,error:y,isLoading:v}=(0,l.ZP)(["applications",t],()=>(0,s.L8)(t)),{mutate:j}=(0,a.kY)(),b=(0,o.useRouter)(),C=null!==(n=null==x?void 0:x.items)&&void 0!==n?n:[],k=e=>{var n;return(null!==(n=e.description)&&void 0!==n?n:"").replace(/\s+/g," ").trim()},w=(e,n)=>{e.target.closest("a")||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),b.push((0,r.C)(n)))};return(0,i.jsxs)("main",{style:u,children:[(0,i.jsx)("header",{style:{display:"flex",flexDirection:"column",gap:16},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:16,flexWrap:"wrap"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{margin:0},children:f}),(0,i.jsx)("p",{style:{margin:0,color:"var(--text-muted)"},children:m})]}),(0,i.jsx)(d.a,{onCreated:async e=>{await j(["applications",t]),b.push((0,r.C)(e.applicationId))}})]})}),v&&(0,i.jsx)("p",{style:p,children:"Loading applications…"}),y&&(0,i.jsx)("p",{style:{...p,color:"var(--danger)"},children:"Failed to load applications"}),!v&&!y&&0===C.length&&(0,i.jsx)("p",{style:p,children:"No applications recorded yet."}),(0,i.jsx)("section",{style:h,children:(0,i.jsx)("div",{className:"status-table-wrapper",children:(0,i.jsx)("div",{className:"status-table-scroll",children:(0,i.jsxs)("table",{className:"status-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"#"}),(0,i.jsx)("th",{scope:"col",children:"Project"}),(0,i.jsx)("th",{scope:"col",children:"PP Ref"}),(0,i.jsx)("th",{scope:"col",children:"LPA Ref"}),(0,i.jsx)("th",{scope:"col",children:"Description"}),(0,i.jsx)("th",{scope:"col",children:"Council"}),(0,i.jsx)("th",{scope:"col",children:"Submitted"}),(0,i.jsx)("th",{scope:"col",children:"Validated"}),(0,i.jsx)("th",{scope:"col",children:"Determination"}),(0,i.jsx)("th",{scope:"col",children:"Outcome"}),(0,i.jsx)("th",{scope:"col",children:"Case Officer"})]})}),(0,i.jsx)("tbody",{children:C.map((e,n)=>{var t,l,a,o,s,d;let u=k(e),p=function(e){var n;if(e.planningPortalUrl)return e.planningPortalUrl;let t=null===(n=e.council)||void 0===n?void 0:n.trim();return t&&c[t]?c[t]:t?"https://www.google.com/search?q=".concat(encodeURIComponent("".concat(t," planning applications"))):void 0}(e);return(0,i.jsxs)("tr",{onClick:()=>b.push((0,r.C)(e.applicationId)),onKeyDown:n=>w(n,e.applicationId),tabIndex:0,children:[(0,i.jsx)("td",{className:"status-table__cell--index",children:n+1}),(0,i.jsx)("td",{className:"status-table__cell--project",title:e.prjCodeName,children:e.prjCodeName}),(0,i.jsx)("td",{title:null!==(t=e.ppReference)&&void 0!==t?t:"—",children:null!==(l=e.ppReference)&&void 0!==l?l:"—"}),(0,i.jsx)("td",{title:null!==(a=e.lpaReference)&&void 0!==a?a:"—",children:null!==(o=e.lpaReference)&&void 0!==o?o:"—"}),(0,i.jsx)("td",{className:"status-table__cell--description",title:u,children:u||"—"}),(0,i.jsx)("td",{className:"status-table__cell--council",title:null!==(s=e.council)&&void 0!==s?s:"—",children:e.council?p?(0,i.jsx)("a",{href:p,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:e.council}):(0,i.jsx)("span",{children:e.council}):"—"}),(0,i.jsx)("td",{children:g(e.submissionDate)}),(0,i.jsx)("td",{children:g(e.validationDate)}),(0,i.jsx)("td",{children:g(e.determinationDate)}),(0,i.jsx)("td",{children:null!==(d=e.outcome)&&void 0!==d?d:"—"}),(0,i.jsx)("td",{children:e.caseOfficer?e.caseOfficerEmail?(0,i.jsx)("a",{href:"mailto:".concat(e.caseOfficerEmail),onClick:e=>e.stopPropagation(),children:e.caseOfficer}):e.caseOfficer:"—"})]},e.applicationId)})})]})})})})]})}function g(e){return e?10===e.length&&/\d{4}-\d{2}-\d{2}/.test(e)?new Date(e).toLocaleDateString():e:"—"}},421:function(e,n,t){"use strict";t.d(n,{Z:function(){return u},q:function(){return d}});var i=t(4896);let l="eu-west-2",a="eu-west-2_Mp5QuBMEE",o="7p4cb8l4k8g9s2e9infoqoc6id",s="eu-west-2:76467ba5-5dcb-45e3-b2e9-91838ab508cd",r="https://hv16oj3j92.execute-api.eu-west-2.amazonaws.com/prod",c=!!(l&&a&&o&&s&&r);c&&i.V.configure({Auth:{Cognito:{userPoolId:a,userPoolClientId:o,identityPoolId:s,loginWith:{username:!1,email:!0,phone:!1}}},API:{REST:{PlanningTrackerApi:{endpoint:r,region:l}}}});let d=c,u=!1},92800:function(e,n,t){"use strict";t.d(n,{L8:function(){return s},UM:function(){return c},VG:function(){return u},W3:function(){return r},_7:function(){return h},ko:function(){return f},li:function(){return p},v:function(){return d}});var i=t(13280),l=t(421);async function a(){if(l.Z||!l.q)return{};try{var e,n;let t=await (0,i.y)(),l=null===(n=t.tokens)||void 0===n?void 0:null===(e=n.idToken)||void 0===e?void 0:e.toString();if(l)return{Authorization:"Bearer ".concat(l)}}catch(e){console.warn("Failed to fetch auth session",e)}return{}}async function o(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=new Headers(n.headers);t.set("Content-Type","application/json"),Object.entries(await a()).forEach(e=>{let[n,i]=e;return t.set(n,i)});let i=await fetch("".concat("https://hv16oj3j92.execute-api.eu-west-2.amazonaws.com/prod").concat(e),{...n,headers:t});if(!i.ok)throw Error(await i.text()||"API request failed");if(204!==i.status)return i.json()}async function s(e){return o("/applications?status=".concat(encodeURIComponent(e)))}async function r(e){return o("/applications",{method:"POST",body:JSON.stringify(e)})}async function c(e){return o("/applications/".concat(e))}async function d(e,n){return o("/applications/".concat(e,"/issues"),{method:"POST",body:JSON.stringify(n)})}async function u(e,n,t){return o("/applications/".concat(e,"/issues/").concat(n),{method:"PATCH",body:JSON.stringify(t)})}async function p(e,n){return o("/applications/".concat(e),{method:"PATCH",body:JSON.stringify(n)})}async function h(e){let n=e?"?status=".concat(encodeURIComponent(e)):"";return o("/issues".concat(n))}async function f(e,n){return o("/applications/".concat(e,"/extensions"),{method:"POST",body:JSON.stringify(n)})}},37844:function(e,n,t){"use strict";function i(e){return"/applications/".concat(e)}t.d(n,{C:function(){return i}})}}]);