# Application Tracker Architecture

## Goals
- Replace spreadsheet-based tracking with a collaborative web app covering submission through determination.
- Remain within AWS free tier where possible for hosting, compute, storage, and authentication.
- Make the solution modular so future paid upgrades (e.g., analytics, notifications) are straightforward.

## High-Level Overview
```
[React Frontend] --HTTPS--> [API Gateway REST API] --Lambda--> [DynamoDB Single Table]
                          \---> [S3 Document Bucket]
                          \---> [EventBridge Scheduler]
                                 |
                                 v
                              [Lambda jobs]
```
- **Frontend**: Next.js (React) single-page application compiled to static assets hosted on AWS Amplify Hosting (uses S3 + CloudFront under the hood and offers a free tier) with CI/CD connected to the Git repository.
- **Authentication**: Amazon Cognito User Pools handle user registration, MFA, password resets. Frontend uses Amplify libraries to authenticate and obtain JWTs.
- **API**: Amazon API Gateway (HTTP API) secured with Cognito authorizer. Routes map to Lambda functions written in TypeScript (Node.js 20 runtime) deployed via AWS SAM/CloudFormation.
- **Data Store**: Amazon DynamoDB single-table design with on-demand capacity (free tier covers 25WCU/25RCU). Stores applications, issues, and timeline events using composite primary keys and global secondary indexes for access patterns.
- **File Storage**: Amazon S3 bucket for supporting documents (validation letters, correspondence). Bucket access restricted via pre-signed URLs generated by backend Lambdas.
- **Background Jobs**: Amazon EventBridge Scheduler triggers periodic Lambdas (e.g., to flag approaching deadlines or sync analytics).
- **Monitoring**: Amazon CloudWatch for logs and metrics. AWS X-Ray can be enabled later for tracing.

## Environments
- **Development**: Local Next.js dev server hitting a local SAM API (sam local) or deployed dev stack in AWS.
- **Staging**: Optional environment mirroring production with separate stacks and Cognito user pools.
- **Production**: Hosted through Amplify, API Gateway/Lambda/DynamoDB in `eu-west-2` (London) to align with UK planning authorities.

## Deployment Workflow
1. Developer pushes to main branch (GitHub/GitLab).
2. AWS CodeBuild or GitHub Actions runs tests, builds frontend and backend artifacts.
3. Backend deploys via AWS SAM/CloudFormation stack (`sam deploy --guided` initially, then automated with parameter overrides).
4. Amplify Hosting pulls latest frontend build or receives build artifact via CI and invalidates CDN cache.

## Security & Compliance
- Use Cognito hosted UI for secure authentication, enable email MFA if required.
- API Gateway enforces JWT verification and rate limits.
- DynamoDB table encryption at rest enabled by default; S3 bucket enforces server-side encryption and private access.
- Configure CloudWatch alarms for elevated error rates and execution duration.
- Set up AWS Backup for DynamoDB (point-in-time recovery) once traffic increases beyond free tier.

## Cost Optimisation
- All services chosen have generous free tiers (Amplify, Cognito, API Gateway, Lambda, DynamoDB on-demand, S3 storage under 5 GB, EventBridge schedules).
- Prefer infrequent scheduled tasks and batched operations to stay within free request quotas.
- Monitor usage with AWS Budgets and alerts set just below free tier thresholds.

## Future Enhancements
- Add SNS or SES notifications for deadline reminders.
- Integrate with Power BI or QuickSight for analytics once data volume grows.
- Introduce role-based access (e.g., Planning Team vs. Management) via Cognito groups.
- Enable Infrastructure as Code with AWS CDK if stack complexity increases.
